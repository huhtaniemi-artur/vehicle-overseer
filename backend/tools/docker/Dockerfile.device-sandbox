FROM python:3

ENV container=docker

RUN apt-get update \
  && apt-get install -y --no-install-recommends \
    iproute2 \
    systemd \
    systemd-sysv \
  && apt-get clean \
  && rm -rf /var/lib/apt/lists/*

# Create common directories but do not install any project code/config.
RUN mkdir -p /opt/vehicle-overseer-device /etc/vehicle-overseer /opt/fordvda \
  && cat > /opt/fordvda/properties.json <<'EOF'
{
    "backend": {
        "mqttServerIp": "tcp://172.18.88.2:11883",
        "mqttUsername": "admin",
        "mqttPassword": "adminpwd",
        "clientId": "simulator"
    }
}
EOF

STOPSIGNAL SIGRTMIN+3
CMD ["/sbin/init"]
